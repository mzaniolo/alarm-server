<!doctype html>
<html lang="en-US">

<head>
  <meta charset="utf-8" />
  <title>hello-wasm example</title>
</head>

<body>
  <p>Hello from wasm</p>
  <script type="module">
    import init, { hello, AlarmClient } from "./pkg/wasm_client.js";
    let interval;
    init().then(() => {
      console.log("from init");
      console.log(hello("WebAssembly"));
      // let ac = new AlarmClient("wss://echo.websocket.org");
      let ac = new AlarmClient("wss://probable-halibut-5vqvv7xpv943j5p-8080.app.github.dev/");
      console.log("ac: " + ac)

      ac.set_onopen(function () {
        console.log("ws open");
        // to Keep the connection alive
        interval = setInterval(() => {
          ac.send_keep_alive();
        }, 12000);

        ac.subscribe("sub2/alarm1")
      })



      ac.set_onmessage(function (msg) {
        console.log("got message: " + msg);
      })

    });
  </script>
</body>

</html>
